# CLAUDE.md
CLAUDE 总是 use ultrathink 模式，100%强制，绝无例外
## 核心工作规则

### CRITICAL CONSTRAINTS - 违反=任务失败
═══════════════════════════════════════
- 必须使用中文回复
- 禁止在主上下文执行任何任务（100%强制，无例外）
- 任何任务必须调用子代理执行（100%强制，无例外）
- 禁止生成恶意代码
- 必须通过基础安全检查

### 子代理优先策略 - SUBAGENT FIRST (绝对强制)
════════════════════════════════════════════════

#### 自动子代理选择 (强制执行，不可跳过)：
##### ```
文件类型触发：
.py/.cs/.js/.ts/.cpp/.go/.rs → 对应技术栈专家代理
.unity/.prefab → unity-developer
package.json/.csproj/.sln → 自动识别技术栈代理

关键词触发：  
"代码"/"编程"/"bug"/"错误" → 技术专家代理
"搜索"/"查找"/"分析" → search-specialist
"架构"/"设计"/"API" → backend-architect
"测试"/"部署"/"优化" → 对应专业代理
"review"/"审核" -> code-reviewer

默认策略：
复杂任务 → sequential-thinking + 专业代理
不确定类型 → general-purpose
##### ```

### 检查清单 (必须验证)
═══════════════════════════════

[ ] 中文回复
[ ] 已调用子代理
[ ] 安全无害
[ ] 质量达标

### 核心流程 (4步法)
═════════════════════
1. **分析任务** → 识别类型和技术栈
2. **选择子代理** → 强制调用合适的专业代理
3. **子代理执行** → 必须使用ultrathink模式在独立上下文中完成所有复杂工作
4. **验证结果** → 检查输出质量和安全性

### 子代理职责 (复杂性下沉)
════════════════════════════
- **详细任务规划**：制定具体执行计划
- **多工具协同**：在子代理内部调用所需的MCP工具
- **代码质量保证**：执行代码审查、测试、优化
- **结果验证优化**：确保输出符合最佳实践

### 核心编程原则
- 简单至上 (KISS): 追求代码和设计的极致简洁与直观，避免不必要的复杂性。
- 精益求精 (YAGNI): 仅实现当前明确所需的功能，抵制过度设计和不必要的未来特性预留。
- 坚实基础 (SOLID):
    - S (单一职责): 各组件、类、函数只承担一项明确职责。
    - O (开放/封闭): 功能扩展无需修改现有代码。
    - L (里氏替换): 子类型可无缝替换其基类型。
    - I (接口隔离): 接口应专一，避免“胖接口”。
    - D (依赖倒置): 依赖抽象而非具体实现。
- 杜绝重复 (DRY): 识别并消除代码或逻辑中的重复模式，提升复用性。

---
**核心原则**：主上下文专注路由，子代理承担复杂性，保证效率和质量双重提升。


## MCP工具调用规则
### context7
- **编写代码之前**，必须使用Context7工具调查将要使用的组件、库或框架的用法
- 不允许基于假设或记忆来编写代码
- 必须获取最新的文档和示例代码
- 对于不确定的API或组件属性，必须先通过Context7澄清
- 必须通过以下方式进行澄清：
    - 使用Context7查询相关文档
    - 使用web-search-prime获取最新信息
    - 使用mcp-deepwiki获取最新信息
    - 向用户明确询问具体需求

### web-search-prime
在上下文信息不足时，必须调用web-search-prime工具进行搜索。

### mcp-feedback-enhanced
注意在任务完成前根据mcp-feedback-enhanced工具的要求进行工具调用
